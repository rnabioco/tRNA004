# tRNA004
Nanopore direct tRNA sequencing method refinement and benchmarking of RNA modification detection between old (RNA002) and new (RNA004) chemistry.

The accompanying manuscript describes how we have leveraged the many well characterized modifications on tRNA (cataloged in [MODOMICS]([url](https://genesilico.pl/modomics/))) to evaluate the signals produced by nanopore basecallers at more than 40 unique types of RNA modifications across both the previous (RNA002) and current (RNA004) nanopore direct RNA sequencing chemistry. In the process, we also quantified the yield and basecalling accuracy improvements that result from switching to RNA004 chemistry for tRNA sequencing, and take advantage of these these higher yields for mitochondrial and bacteriophage tRNA sequence analysis, including RNA modification detection on low abundance tRNAs. We also detail a few methodological improvements to nanopore tRNA sequencing protocols, including the use of tRNA-specific SPRI beads and optimized molar ratios for all ligations.

This repository contains an R project and associated R markdown documents to generate the plots throughout the manuscript (in `rmd`), as well as custom scripts used for alignment, read filtering, quantification of abundance, calculation of basecalling errors and annotation of tRNA references with modification location in `src`. The subdirectory `bcerror` contains tsvs with outputs of some of these for modification induced error analysis, which are directly called by the R markdown documents to generate plots. The directory `modplots` contains additional plots for all 43 RNA modifications evaluated in the manuscript, at all sequence contexts >29X coverage in RNA004 supv5 basecalled data. These plots are not included in the manuscript, but are generated using the function `plot_modification_data` in `rmd/fig2_RNA_mods.Rmd`.

Finally, we have also confirmed that the default MinKNOW settings for RNA004 libraries recapitulate the solution to the read length problem identified in [Lucas et al. 2023]([url](https://www.nature.com/articles/s41587-023-01743-6)) and described in more detail for RNA002 libraries [here]([url](https://lkwhite.github.io/tRNAseq/sequencing-settings/)), enabling real time capture of short reads without simulation or any editing of `.toml` files. [NB: this isn't covered in detail in the accompanying manuscript; we just went line by line in the `sequencing_PRO004RA_RNA.toml` and `sequencing_MIN106_RNA.toml` settings to confirm the relevant settings all matched. An upcoming "RNA short mode" announced by ONT in May 2024 has the potential to alter these settings; you can check them yourself in your MinKNOW directory under `/Applications/MinKNOW.app/Contents/Resources/conf/package/sequencing` on a Mac, or `/opt/ont/minknow/conf/package/` on a Linux machine.

Data associated with this manuscript have been uploaded to XXXXXX bioproject ID XXXXXX
